var http=require("http");var key="59936cbc7642729f6f519c130c530bdd";var baseUrl="api.uwaterloo.ca";function process(b,c){var a=b.split(" ");switch(a[1]){case"weather":getWeather(function(d){c(d)});break;case"exam":if(a.length==4){getExamSchedule(a[2],a[3],function(d){c(d)})}else{c(returnHelpString())}break;case"help":c("Address bot with <b>@uwbot</b> or <b>@bot</b> (command) (options) <br>         <b>UWBot commands:</b> <br>           <b>weather</b>: get the current weather in waterloo <br>           <b>exam</b> (subject) (course_num): Gets exam info for given subject <br>           <b>disclaimer</b>: Prints a boring disclaimer <br>           <b>help</b>: print this help command <br>");break;case"disclaimer":c("All information from api.uwaterloo.ca, the author provides no guarentees to its correctness.");break;default:c(returnHelpString());break}}function returnHelpString(){return"Unrecognized command, please refer to '@bot help' for accepted command."}function getCurrentTerm(c){var a="/v2/terms/list.json?key="+key;var b;sendReq(a,function(d){b=JSON.parse(d);c(b.data.current_term)})}function getExamSchedule(a,d,f){var c="/v2/courses/"+a+"/"+d+"/examschedule.json?key="+key;var b;var e;sendReq(c,function(g){e=JSON.parse(g);if(typeof e.data.course!=="undefined"){b="Exam Info for "+e.data.course+": <br>";for(section in e.data.sections){b+="Section: "+e.data.section.section+"<br>         Date: "+e.data.section.date+"<br>         Start Time: "+e.data.section.start_time+"<br>         End Time: "+e.data.section.end_time+"<br>         Location: "+e.data.section.location+"<br>         "}}else{b="Cannot get exam information for '"+a+d+"'!"}f(b)})}function getWeather(d){var b="/v2/weather/current.json";var a;var c;sendReq(b,function(e){c=JSON.parse(e);a="The current temperature in Waterloo is: "+c.data.temperature_current_c+" Celsius";d(a)})}function sendReq(b,d){var a={host:baseUrl,port:80,path:b,method:"GET",headers:{"Content-Type":"application/json"}};var c=http.get(a,function(e){var f=[];e.on("data",function(g){f.push(g)}).on("end",function(){var g=Buffer.concat(f);d(g)})});c.on("error",function(f){console.log("ERROR: "+f.message)})}module.exports.process=process;